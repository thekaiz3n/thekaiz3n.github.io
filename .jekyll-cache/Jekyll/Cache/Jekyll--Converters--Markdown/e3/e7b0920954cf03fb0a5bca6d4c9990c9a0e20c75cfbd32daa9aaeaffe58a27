I"ã<p><img src="/assets/images/ctf/htb-writeup-baby-interdimensional-internet/synack.png" alt="center-aligned-image" class="align-center" /></p>

<p>Baby is a easy machine, created by the Synack Red Team Track, to read the source code, manipulate post requestions and in inject commands, in flask application</p>

<h2 id="web-page">Web Page</h2>

<p>Initialy we see a web page where has a number.</p>

<p><img src="/assets/images/ctf/htb-writeup-baby-interdimensional-internet/1.png" alt="" /></p>

<p>Search in source code, a directory /debug, in commented.</p>

<p><img src="/assets/images/ctf/htb-writeup-baby-interdimensional-internet/2.png" alt="" /></p>

<p>In this directory has a source code from a flask application. Has two accepted methods, POST and GET, with two parameters ‚Äúaccepted‚Äù and ‚Äúaccepted‚Äù.</p>

<p><img src="/assets/images/ctf/htb-writeup-baby-interdimensional-internet/3.png" alt="" /></p>

<p>Now we can in burp, using repeater, send a post requestion to application. The application is vulnerable to a command injection, we can sen a exec command to python that will run the command and return the code.</p>

<p><img src="/assets/images/ctf/htb-writeup-baby-interdimensional-internet/4.png" alt="" /></p>

<h2 id="observations">Observations</h2>

<p><strong>HTTP HEADER</strong><br />
Have to add the content-type, to work the request.<br />
Font: https://www.geeksforgeeks.org/http-headers-keep-alive/</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
content-type: application/x-www-form-urlencoded

</code></pre></div></div>
<p><strong>Python exec Payload</strong><br />
Font: https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>eval('__import__(\'os\').popen(\'ls\').read()')

</code></pre></div></div>
:ET